import re
import matplotlib.pyplot as plt

# 输入的文本
text = """
[train epoch 0] loss: 2.178, acc: 0.543: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 0] loss: 1.798, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 1] loss: 2.189, acc: 0.594: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 1] loss: 1.283, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 2] loss: 2.113, acc: 0.578: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 2] loss: 1.022, acc: 0.608: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 3] loss: 2.491, acc: 0.591: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 3] loss: 1.246, acc: 0.587: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 4] loss: 2.110, acc: 0.617: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 4] loss: 2.078, acc: 0.664: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 5] loss: 2.269, acc: 0.606: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 5] loss: 2.856, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 6] loss: 2.262, acc: 0.601: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 6] loss: 2.944, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 7] loss: 1.777, acc: 0.601: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 7] loss: 3.852, acc: 0.573: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 8] loss: 1.599, acc: 0.636: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 8] loss: 2.418, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 9] loss: 1.837, acc: 0.661: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 9] loss: 1.481, acc: 0.636: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 10] loss: 1.823, acc: 0.626: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 10] loss: 1.034, acc: 0.692: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 11] loss: 1.566, acc: 0.631: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 11] loss: 1.879, acc: 0.636: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 12] loss: 1.325, acc: 0.626: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 12] loss: 2.036, acc: 0.615: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 13] loss: 1.137, acc: 0.668: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 13] loss: 1.679, acc: 0.650: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 14] loss: 1.145, acc: 0.668: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 14] loss: 1.337, acc: 0.671: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 15] loss: 1.032, acc: 0.643: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 15] loss: 1.291, acc: 0.643: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [
[train epoch 16] loss: 0.979, acc: 0.654: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [
[valid epoch 20] loss: 1.371, acc: 0.608: 100%|██████████████████████████████████████████████████████████████████████| 18/18
[train epoch 21] loss: 0.681, acc: 0.707: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [02:28<00:00,  2.07s/it]
[valid epoch 21] loss: 1.153, acc: 0.622: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:47<00:00,  2.64s/it]
[train epoch 22] loss: 0.673, acc: 0.692: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [02:28<00:00,  2.06s/it]
[valid epoch 22] loss: 1.185, acc: 0.622: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:47<00:00,  2.65s/it]
[train epoch 23] loss: 0.588, acc: 0.757: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [02:27<00:00,  2.05s/it]
[valid epoch 23] loss: 1.358, acc: 0.615: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:47<00:00,  2.62s/it]
"""

# 使用正则表达式提取训练集和验证集的损失和准确率
pattern_train = r"\[train epoch (\d+)\] loss: (\d+\.\d+), acc: (\d+\.\d+):"
pattern_valid = r"\[valid epoch (\d+)\] loss: (\d+\.\d+), acc: (\d+\.\d+):"
matches_train = re.findall(pattern_train, text)
matches_valid = re.findall(pattern_valid, text)

# 提取出 epoch，损失和准确率
epochs_train = [int(match[0]) for match in matches_train]
losses_train = [float(match[1]) for match in matches_train]
accuracies_train = [float(match[2]) for match in matches_train]

epochs_valid = [int(match[0]) for match in matches_valid]
losses_valid = [float(match[1]) for match in matches_valid]
accuracies_valid = [float(match[2]) for match in matches_valid]

# 绘制损失曲线
plt.figure(figsize=(12, 6))
plt.subplot(1, 2, 1)
plt.plot(epochs_train, losses_train, marker='o', label='Train Loss')
plt.plot(epochs_valid, losses_valid, marker='o', label='Valid Loss')
plt.title('Loss over epochs')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()

# 绘制准确率曲线
plt.subplot(1, 2, 2)
plt.plot(epochs_train, accuracies_train, marker='o', label='Train Accuracy')
plt.plot(epochs_valid, accuracies_valid, marker='o', label='Valid Accuracy')
plt.title('Accuracy over epochs')
plt.xlabel('Epochs')
plt.ylabel('Accuracy')
plt.legend()

plt.tight_layout()
plt.show()