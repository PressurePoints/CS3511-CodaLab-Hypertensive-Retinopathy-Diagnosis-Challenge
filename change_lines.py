import re
import matplotlib.pyplot as plt

# 输入的文本
text = """
[train epoch 0] loss: 1.552, acc: 0.569: 100%|█████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.57s/it]     
[valid epoch 0] loss: 1.373, acc: 0.657: 100%|█████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.94s/it]     
[train epoch 1] loss: 2.714, acc: 0.594: 100%|█████████████████████████████████████████████████| 72/72 [01:55<00:00,  1.61s/it]     
[valid epoch 1] loss: 1.615, acc: 0.615: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:32<:32<00:00,  1.83s/it]
[train epoch 2] loss: 3.366, acc: 0.575: █████████████████████████████████████████████████████████████████████| 72/72 [01:54<00:00,  1.59s/it]
[valid epoch 2] loss: 1.509, acc: 0.692: 100%|█████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.92s/it]
[train epoch 3] loss: 2.539, acc: 0.587: 100%|█████████████████████████████████████████████████| 72/72 [01:57<00:00,  1.64s/it]
[valid epoch 3] loss: 1.362, acc: 0.622: 100%|█████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.92s/it]
[train epoch 4] loss: 2.575, acc: 0.617: 100%|█████████████████████████████████████████████████| 72/72 [01:52<00:00,  1.56s/it]
[valid epoch 4] loss: 1.888, acc: 0.608: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 5] loss: 2.430, acc: 0.624: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [01:50<
[valid epoch 5] loss: 1.460, acc: 0.706: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:33<
[train epoch 6] loss: 2.178, acc: 0.608: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 6] loss: 1.598, acc: 0.643: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:33<
[train epoch 7] loss: 2.135, acc: 0.583: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [01:51<
[valid epoch 7] loss: 1.765, acc: 0.643: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 8] loss: 2.568, acc: 0.613: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 8] loss: 4.175, acc: 0.580: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 9] loss: 2.225, acc: 0.592: 100%|███████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 9] loss: 2.743, acc: 0.517: 100%|███████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 10] loss: 1.665, acc: 0.626: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 10] loss: 1.305, acc: 0.664: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 11] loss: 1.343, acc: 0.689: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 11] loss: 1.296, acc: 0.671: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 12] loss: 2.230, acc: 0.589: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:49<
[valid epoch 16] loss: 2.251, acc: 0.497: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:32<
[train epoch 17] loss: 1.168, acc: 0.633: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:48<:48<00:00,  1.51s/it]
[valid epoch 17] loss: 1.132, acc: 0.629: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:32<:32<00:00,  1.81s/it]
[train epoch 18] loss: 1.065, acc: 0.649: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:49<:49<00:00,  1.52s/it]
[valid epoch 18] loss: 0.833, acc: 0.699: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:32<:32<00:00,  1.80s/it]
[train epoch 19] loss: 1.025, acc: 0.617: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:48<:48<00:00,  1.51s/it]
[valid epoch 19] loss: 1.097, acc: 0.608: 100%|██████████████████████████████████████████████████████████████████████| 18/18 [00:33<:33<00:00,  1.85s/it]
[train epoch 20] loss: 1.069, acc: 0.641: 100%|██████████████████████████████████████████████████████████████████████| 72/72 [01:56<00:00,  1.62s/it]
[valid epoch 20] loss: 0.759, acc: 0.741: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.90s/it] 
[train epoch 21] loss: 0.785, acc: 0.680: 100%|████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.57s/it]
[valid epoch 21] loss: 0.700, acc: 0.734: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.90s/it] 
[train epoch 22] loss: 0.804, acc: 0.685: 100%|████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.58s/it]
[valid epoch 22] loss: 1.121, acc: 0.608: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 23] loss: 0.828, acc: 0.645: 100%|████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.57s/it]
[valid epoch 23] loss: 0.830, acc: 0.657: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 24] loss: 0.797, acc: 0.668: 100%|████████████████████████████████████████████████| 72/72 [01:54<00:00,  1.58s/it]
[valid epoch 24] loss: 0.960, acc: 0.622: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.91s/it] 
[train epoch 25] loss: 0.721, acc: 0.670: 100%|████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.58s/it]
[valid epoch 25] loss: 0.688, acc: 0.692: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 26] loss: 0.706, acc: 0.680: 100%|████████████████████████████████████████████████| 72/72 [01:53<00:00,  1.58s/it]
[valid epoch 26] loss: 0.713, acc: 0.657: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 27] loss: 0.675, acc: 0.687: 100%|████████████████████████████████████████████████| 72/72 [01:52<00:00,  1.56s/it] 
[valid epoch 27] loss: 0.727, acc: 0.706: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 28] loss: 0.651, acc: 0.689: 100%|████████████████████████████████████████████████| 72/72 [01:52<00:00,  1.57s/it] 
[valid epoch 28] loss: 0.800, acc: 0.671: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 
[train epoch 29] loss: 0.687, acc: 0.666: 100%|████████████████████████████████████████████████| 72/72 [01:52<00:00,  1.56s/it] 
[valid epoch 29] loss: 0.774, acc: 0.657: 100%|████████████████████████████████████████████████| 18/18 [00:34<00:00,  1.89s/it] 

"""

# 使用正则表达式提取损失和准确率
# 使用正则表达式提取训练集和验证集的损失和准确率
pattern_train = r"\[train epoch (\d+)\] loss: (\d+\.\d+), acc: (\d+\.\d+):"
pattern_valid = r"\[valid epoch (\d+)\] loss: (\d+\.\d+), acc: (\d+\.\d+):"
matches_train = re.findall(pattern_train, text)
matches_valid = re.findall(pattern_valid, text)

# 提取出 epoch，损失和准确率
epochs_train = [int(match[0]) for match in matches_train]
losses_train = [float(match[1]) for match in matches_train]
accuracies_train = [float(match[2]) for match in matches_train]

epochs_valid = [int(match[0]) for match in matches_valid]
losses_valid = [float(match[1]) for match in matches_valid]
accuracies_valid = [float(match[2]) for match in matches_valid]

# 绘制损失曲线
plt.figure(figsize=(12, 6))
plt.subplot(1, 2, 1)
plt.plot(epochs_train, losses_train, marker='o', label='Train Loss')
plt.plot(epochs_valid, losses_valid, marker='o', label='Valid Loss')
plt.title('Loss over epochs')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()

# 绘制准确率曲线
plt.subplot(1, 2, 2)
plt.plot(epochs_train, accuracies_train, marker='o', label='Train Accuracy')
plt.plot(epochs_valid, accuracies_valid, marker='o', label='Valid Accuracy')
plt.title('Accuracy over epochs')
plt.xlabel('Epochs')
plt.ylabel('Accuracy')
plt.legend()

plt.tight_layout()
plt.show()